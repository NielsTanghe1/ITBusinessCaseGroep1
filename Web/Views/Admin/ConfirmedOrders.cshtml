@model List<Web.Consumers.OrderConfirmedMessage>

@{
	ViewData["Title"] = "Bevestigde Bestellingen";
}

<div class="container mt-4">
	<div class="d-flex justify-content-between align-items-center mb-4">
		<h2>📦 Bevestigde Bestellingen (uit Queue)</h2>
		<a asp-controller="Admin" asp-action="Index" class="btn btn-secondary">
			Terug naar Admin
		</a>
	</div>

	@if (Model == null || !Model.Any())
	{
		<div class="alert alert-info">
			<i class="bi bi-info-circle"></i>
			Geen bevestigde bestellingen gevonden in de queue.
		</div>
	}
	else
	{
		<div class="card">
			<div class="card-header bg-primary text-white">
				<strong>Totaal aantal bestellingen:</strong> @Model.Count
			</div>
			<div class="card-body p-0">
				<div class="table-responsive">
					<table class="table table-hover table-striped mb-0">
						<thead class="table-dark">
							<tr>
								<th>Order ID</th>
								<th>Gebruiker ID</th>
								<th>Status</th>
								<th>Bevestigd op</th>
								<th>Acties</th>
							</tr>
						</thead>
						<tbody>
							@foreach (var order in Model.OrderByDescending(o => o.ConfirmedAt))
							{
								<tr>
									<td>
										<strong>#@order.OrderId</strong>
									</td>
									<td>
										<span class="badge bg-info">@order.CoffeeUserId</span>
									</td>
									<td>
										@if (order.Status == "Confirmed")
										{
											<span class="badge bg-success">@order.Status</span>
										}
										else if (order.Status == "Processing")
										{
											<span class="badge bg-warning">@order.Status</span>
										}
										else
										{
											<span class="badge bg-secondary">@order.Status</span>
										}
									</td>
									<td>
										<small class="text-muted">
											@order.ConfirmedAt.ToString("dd-MM-yyyy HH:mm:ss")
										</small>
									</td>
									<td>
										<a asp-controller="Admin" 
										   asp-action="OrderDetails" 
										   asp-route-id="@order.OrderId" 
										   class="btn btn-sm btn-outline-primary">
											Details
										</a>
									</td>
								</tr>
							}
						</tbody>
					</table>
				</div>
			</div>
		</div>

		<div class="mt-3">
			<small class="text-muted">
				<i class="bi bi-info-circle"></i>
				Deze bestellingen worden ontvangen via de MassTransit OrderConfirmed queue.
			</small>
		</div>
	}
</div>