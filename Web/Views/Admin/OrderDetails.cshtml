@model Web.Controllers.AdminOrderDetailsViewModel
@{
	ViewData["Title"] = "Order details";
	var p = Model.Payload;
}

<div class="admin-header mb-3 d-flex align-items-center justify-content-between">
	<div>
		<h2 class="mb-1">Order details</h2>
		<div class="text-muted">Bekijk orderinformatie en lijnen.</div>
	</div>
	<div class="d-flex gap-2">
		<a asp-action="Orders" class="btn btn-outline-secondary">← Terug</a>
	</div>
</div>

<div class="row g-3">
	<div class="col-lg-6">
		<div class="card h-100">
			<div class="card-body">
				<h5 class="mb-3">Order</h5>
				<div><strong>OrderId:</strong> @Model.OrderId</div>
				<div><strong>Status:</strong> <span class="badge bg-primary">@Model.Status</span></div>
				<div><strong>Datum (UTC):</strong> @Model.CreatedAtUtc</div>
			</div>
		</div>
	</div>

	<div class="col-lg-6">
		<div class="card h-100">
			<div class="card-body">
				<h5 class="mb-3">Klant</h5>
				<div><strong>Naam:</strong> @(p != null ? $"{p.FirstName} {p.LastName}".Trim() : "-")</div>
				<div><strong>Email:</strong> @(p?.Email ?? "-")</div>
				<div><strong>Totaal:</strong> @(p?.Total?.ToString("0.00") ?? "-")</div>
			</div>
		</div>
	</div>

	<div class="col-lg-6">
		<div class="card h-100">
			<div class="card-body">
				<h5 class="mb-3">Adres</h5>
				<div>@(p?.Street ?? "-")</div>
				<div>Postbus: @(p?.Postbus ?? "-")</div>
				<div>@(p?.Postcode ?? "-") @(p?.City ?? "-")</div>
				<div>@(p?.Country ?? "-")</div>
			</div>
		</div>
	</div>

	<div class="col-lg-6">
		<div class="card h-100">
			<div class="card-body">
				<h5 class="mb-3">Order lijnen</h5>

				<div class="table-responsive">
					<table class="table table-sm table-striped align-middle mb-0">
						<thead>
							<tr>
								<th>Product</th>
								<th>Unit</th>
								<th>Qty</th>
								<th>Total</th>
							</tr>
						</thead>
						<tbody>
							@if (p?.Lines != null && p.Lines.Count > 0) {
								foreach (var line in p.Lines) {
									<tr>
										<td>
											<div class="fw-semibold">@line.CoffeeType</div>
											<div class="text-muted small">@line.CoffeeId</div>
										</td>
										<td>@(line.UnitPrice.ToString("0.00") ?? "-")</td>
										<td>@(line.Quantity.ToString() ?? "-")</td>
									</tr>
								}
							} else {
								<tr><td colspan="4" class="text-muted">Geen lijnen gevonden.</td></tr>
							}
						</tbody>
					</table>
				</div>

			</div>
		</div>
	</div>
</div>

<div class="accordion mt-3" id="rawJsonAcc">
	<div class="accordion-item">
		<h2 class="accordion-header" id="headingRaw">
			<button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseRaw">
				Raw JSON
			</button>
		</h2>
		<div id="collapseRaw" class="accordion-collapse collapse" data-bs-parent="#rawJsonAcc">
			<div class="accordion-body">
				<pre class="admin-json">@Model.RawJson</pre>
			</div>
		</div>
	</div>
</div>
